<dom-module id="haushaltsbuch-select-shop-list">
<style>


#expenseList {
  width: 100%;
  min-width:
}

.item {
  border-bottom-color: rgb(221, 221, 221);
  border-bottom-style: solid;
  border-bottom-width: 1px;

  display: flex;
  flex-direction: row;
  font-family: Roboto, Noto, sans-serif;
  font-weight: 300;
  font-size: 14px;
  cursor: pointer;
  padding: 16px 16px;
}

</style>
  <template>

    <iron-localstorage
      name="expensePlaces"
      value="{{expensePlaces}}"
      on-iron-localstorage-load-empty="initializeDefaultExpensePlaces"
    ></iron-localstorage>


    <iron-list items="{{expensePlaces}}" as="item" id="expenseList">
      <template>
        <div class="item" on-click="selectShop">
          <paper-ripple></paper-ripple>
          <div>[[_computeListItem(item.shop, item.town)]]</div>
        </div>
      </template>
    </iron-list>
  </template>

<script>
(function() {
  Polymer({
    is: 'haushaltsbuch-select-shop-list',

    properties: {
      expensePlace : {
        type: Object,
        notify: true
      },

      town : {
        type: String,
        notify: true
      },

      expensePlaces : {
        type: Array,
        notifiy: true
      }
    },

    ready : function() {
    },

    attached : function() {
    },

    _computeListItem : function(shop, town) {
      return shop + ", " + town;
    },

    initializeDefaultExpensePlaces : function () {
      this.expensePlaces = [{"shop":  "REWE", "town": "Philippsburg"}, {"shop": "Globus", "town" : "Wiesental"}];
    },

    selectShop : function(e) {
      this.expensePlace = e.model.item;
    },

    addExpensePlace : function (expensePlace) {
      if (expensePlace && expensePlace.town != "" && expensePlace.shop != "") {
        // only add unique places
        var isUnique = true;

        this.expensePlaces.forEach(function(place, i) {
          if (place.town == expensePlace.town && place.shop == expensePlace.shop) {
            isUnique = false;
            return;
          }
        });

        if (isUnique) {
           this.push('expensePlaces', this.expensePlace);
        }
      }
   },
  });
})();
</script>

</dom-module>
